rule "Smart Margaret Room Rule"
when
	Item SmartMargaretBedroom received command
then
	logWarn("Bigboxer23", "Smart Margaret: " + receivedCommand + " " + now.getHourOfDay + " " + MargaretLight.state)
	if (receivedCommand == OFF)
	{
		MargaretLight.sendCommand(receivedCommand);
		if (now.getHourOfDay >= 7 && now.getHourOfDay < 19)
		{
			MargaretFan.sendCommand(receivedCommand);
			MaggieLamp.sendCommand(receivedCommand);
			MargaretsAccent.sendCommand(receivedCommand);
		} else
		{
			MaggieLamp.sendCommand(new HSBType(new DecimalType(307),new PercentType(82),new PercentType(1)))
			MargaretsAccent.sendCommand(new HSBType(new DecimalType(307),new PercentType(82),new PercentType(1)))
			Hallway.sendCommand(receivedCommand);
			Upstairs.sendCommand(receivedCommand);
			EntryWay.sendCommand(receivedCommand);
		}
	} else
	{
		if (now.getHourOfDay >= 7 && now.getHourOfDay < 19)
		{
			if (receivedCommand == ON)
			{
				MargaretLight.sendCommand(100);
			} else
			{
				MargaretLight.sendCommand(receivedCommand);
			}
			MargaretFan.sendCommand(OFF);
		} else
		{
			if (receivedCommand == ON)
			{
				MargaretLight.sendCommand(20);
				MaggieLamp.sendCommand(new HSBType(new DecimalType(33),new PercentType(42),new PercentType(100)))
				MargaretsAccent.sendCommand(new HSBType(new DecimalType(82),new PercentType(42),new PercentType(100)))
				MargaretFan.sendCommand(receivedCommand);
			} else
			{
				MargaretLight.sendCommand(receivedCommand);
				MaggieLamp.sendCommand(new HSBType(new DecimalType(33),new PercentType(42),new PercentType(receivedCommand.toString)))
				MargaretsAccent.sendCommand(new HSBType(new DecimalType(33),new PercentType(42),new PercentType(receivedCommand.toString)))
			}
		}
	}
end